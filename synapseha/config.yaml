# SynapseHA Add-on Configuration
name: SynapseHA
version: 1.0.0
slug: synapseha
description: MCP server for Home Assistant providing 21 tools for LLM-driven control and maintenance
url: https://github.com/hellosamblack/SynapseHA

# Supported architectures
arch:
  - aarch64
  - amd64
  - armv7
  - i386

# Startup configuration
startup: application
boot: auto

# Disable S6-Overlay init system (we use our own Node.js process)
init: false

# Network ports
ports:
  3000/tcp: 3000
ports_description:
  3000/tcp: MCP Server HTTP/SSE endpoint for external MCP clients

# Ingress is disabled as this is an API-only service
ingress: false

# Home Assistant API access - auto-injects SUPERVISOR_TOKEN
homeassistant_api: true
hassio_api: true
hassio_role: default
auth_api: true

# Persistent storage
map:
  - addon_config:rw
  - ssl:ro

# User-configurable options
options:
  log_level: info
  http_port: 3000
  bearer_token: ""
  require_auth: false
  cache_refresh_interval: 60
  entity_cache_enabled: true

# Schema validation
schema:
  log_level: list(debug|info|warn|error)
  http_port: port
  bearer_token: str?
  require_auth: bool
  cache_refresh_interval: int(10,3600)
  entity_cache_enabled: bool

# Environment variables
environment:
  NODE_ENV: production

# Add-on privileges
privileged: []
host_network: false
host_pid: false

# Watchdog for auto-restart
watchdog: "http://[HOST]:[PORT:3000]/health"
