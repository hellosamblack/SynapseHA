# MCP Home Assistant Bridge Add-on Configuration
name: "MCP Home Assistant Bridge"
version: "1.0.0"
slug: "mcp_ha_bridge"
description: "Model Context Protocol server for Home Assistant integration with GitHub Copilot and LLM tooling. Provides 20 tools for controlling smart home devices, monitoring states, and analyzing history with intelligent entity resolution."
url: "https://github.com/hellosamblack/SynapseHA"

# Supported architectures
arch:
  - aarch64
  - amd64
  - armv7
  - i386

# Startup configuration
startup: application
boot: auto

# Disable S6-Overlay init system (we use our own Node.js process)
init: false

# Network ports
ports:
  3000/tcp: 3000
ports_description:
  3000/tcp: "MCP Server HTTP/SSE endpoint for external clients"

# Ingress is disabled as this is an MCP server without a web UI
ingress: false

# Home Assistant API access - auto-injects SUPERVISOR_TOKEN
homeassistant_api: true
hassio_api: true
hassio_role: default
auth_api: true

# Persistent storage
map:
  - addon_config:rw
  - ssl:ro

# User-configurable options
options:
  log_level: "info"
  http_port: 3000
  bearer_token: ""
  require_auth: false
  cache_refresh_interval: 60
  entity_cache_enabled: true

# Schema validation
schema:
  log_level: list(debug|info|warn|error)
  http_port: port
  bearer_token: str?
  require_auth: bool
  cache_refresh_interval: int(10,3600)
  entity_cache_enabled: bool

# Environment variables
environment:
  NODE_ENV: production

# Add-on privileges
privileged: []
host_network: false
host_pid: false

# Note: Watchdog disabled as this server uses STDIO transport (no HTTP endpoints)
# watchdog: "http://[HOST]:[PORT:3000]/health"

# Image name for Docker Hub (if publishing)
# image: "ghcr.io/hellosamblack/ha-mcp-bridge-addon/{arch}"
